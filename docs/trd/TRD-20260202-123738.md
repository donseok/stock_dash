# 주식 웹 포털 대시보드 - 기술 요구사항 문서 (TRD)

**버전**: 1.1 | **상태**: REVISED
**생성일**: 2026-02-02 12:37 | **수정일**: 2026-02-02
**원본 PRD**: 주식 웹 포털 대시보드 (PRD-20260202-7b9a)

---

## 1. 기술 요약

기술 요약문: 통합 투자 웹 포털 대시보드

본 프로젝트는 주식, 암호화폐, 귀금속 등 다양한 자산군의 실시간 시세와 시장 정보를 단일 플랫폼에서 제공하는 통합 웹 포털 대시보드를 구축하는 것을 목표로 한다.

핵심 기술 결정사항으로 프론트엔드는 Next.js 14와 TypeScript를, 백엔드는 Python 3.12 기반 FastAPI를 채택하였다. 데이터 저장소는 PostgreSQL 16을 주 데이터베이스로, Redis를 캐싱 레이어로 활용한다. 외부 시세 데이터는 Upbit WebSocket API와 키움증권 Open API를 통해 수집한다.

아키텍처는 레이어드와 이벤트 기반 하이브리드 방식을 적용하였다. 레이어드 구조로 프론트엔드와 백엔드의 관심사를 명확히 분리하고, WebSocket 기반 이벤트 드리븐 방식으로 실시간 시세 스트리밍을 구현한다. Redis 캐싱을 통해 저지연 고성능 데이터 전달을 확보하며, 위젯 기반의 유연한 대시보드 구조로 사용자가 종목을 자유롭게 교체할 수 있도록 설계하였다. 총 10개의 주요 기능과 1개의 비기능 요구사항을 포함한다.

주요 기술 리스크로는 외부 API 의존성에 따른 장애 전파 가능성이 있으며, Redis 캐싱과 폴백 메커니즘으로 대응한다. WebSocket 동시 접속 증가 시 서버 부하 문제는 커넥션 풀링과 수평 확장으로 해결하고, 다수 외부 API의 데이터 포맷 불일치는 통합 어댑터 레이어를 통해 일관된 인터페이스를 제공할 계획이다.

## 2. 기술 스택

### Frontend

- Next.js 14
- TypeScript
- Tailwind CSS
- TradingView Lightweight Charts
- TanStack Query

**선정 이유**: Next.js 14는 SSR/SSG를 통한 초기 로딩 최적화와 App Router 기반의 효율적인 라우팅을 제공합니다. TradingView Lightweight Charts는 무료 오픈소스 차트 라이브러리로 주식/코인 캔들차트, 라인차트 등 금융 차트에 최적화되어 있습니다. TanStack Query는 실시간 데이터 폴링 및 캐싱 전략을 통해 업비트 API, 시세 API의 빈번한 데이터 갱신을 효율적으로 처리합니다. Tailwind CSS는 대시보드 레이아웃의 반응형 그리드 구성에 생산성이 높습니다.

### Backend

- Python 3.12
- FastAPI
- WebSocket
- httpx
- APScheduler

**선정 이유**: FastAPI는 비동기(async/await) 네이티브 지원으로 업비트 WebSocket API, 외부 시세 API 다중 동시 호출에 적합합니다. WebSocket을 통해 프론트엔드에 실시간 시세 데이터를 푸시할 수 있어 실시간 차트 업데이트 요구사항을 충족합니다. httpx는 비동기 HTTP 클라이언트로 키움증권 Open API, 금/은 시세 API 등 다수의 외부 API를 효율적으로 호출합니다. APScheduler는 정기적 시세 수집 및 캐시 갱신 스케줄링에 활용합니다. 무료이며 커뮤니티가 활발합니다.

### Database

- PostgreSQL 16
- Redis

**선정 이유**: PostgreSQL은 종목 메타정보, 뉴스 데이터, 사용자 설정(종목 교체 구성) 등 구조화된 데이터 저장에 적합하며 JSONB 타입으로 유연한 종목 설정 스키마를 지원합니다. Redis는 실시간 시세 데이터의 인메모리 캐싱, WebSocket 세션 관리, API 호출 결과 캐싱에 활용하여 외부 API 호출 빈도를 줄이고 응답 속도를 보장합니다. 둘 다 무료 오픈소스입니다.

### External APIs

- Upbit WebSocket API
- 키움증권 Open API
- Gold API (metals.live)
- 한국수출입은행 환율 API
- NewsAPI

**선정 이유**: 업비트 WebSocket API는 비트코인, 이더리움, 솔라나, XRP, 체인링크, SUI, ONDO 등 암호화폐 실시간 시세를 무료로 제공합니다. 키움증권 Open API는 국내주식(에스피지, 에코프로, 셀트리온) 시세, KOSPI/KOSDAQ 지수, 해외주식(비트마인, 알파벳 C, 피그마), 해외 다우/NASDAQ 지수를 제공합니다. metals.live 또는 GoldAPI.io 무료 티어로 금/은 시세를 조회합니다. 한국수출입은행 환율 API로 USD/KRW 등 주요 환율을 무료 조회합니다. NewsAPI 무료 티어로 주식 관련 뉴스를 수집합니다.

### Infrastructure

- Docker
- Docker Compose
- Nginx
- AWS EC2 (or Oracle Cloud Free Tier)
- GitHub Actions

**선정 이유**: Docker와 Docker Compose로 Frontend, Backend, PostgreSQL, Redis를 컨테이너화하여 일관된 배포 환경을 구성합니다. 중간 수준의 확장성 요구에 맞춰 Kubernetes 대신 단일 인스턴스 Docker Compose 구성으로 시작하고, 트래픽 증가 시 컨테이너 수평 확장이 가능합니다. Nginx는 리버스 프록시 및 정적 파일 서빙에 활용합니다. 무료 소프트웨어 제약사항에 따라 Oracle Cloud Free Tier(Always Free) 또는 AWS Free Tier EC2를 활용할 수 있습니다. GitHub Actions로 CI/CD 파이프라인을 무료로 구성합니다.

### Monitoring & Logging

- Prometheus
- Grafana
- Python logging

**선정 이유**: Prometheus와 Grafana는 무료 오픈소스로 API 호출 상태, WebSocket 연결 수, 시세 데이터 갱신 주기 등 핵심 메트릭을 모니터링합니다. 표준 보안 수준에서 시스템 상태 파악과 장애 대응에 필수적이며, 대시보드 서비스의 안정성을 보장합니다.

## 3. 시스템 아키텍처

### 3.1 아키텍처 개요

주식 웹 포털 대시보드는 실시간 시세 데이터(국내/해외 주식, 암호화폐, 금/은)와 뉴스를 통합 제공하는 플랫폼으로, Next.js 기반 프론트엔드와 FastAPI 기반 백엔드로 구성된 레이어드 아키텍처를 채택합니다. WebSocket을 통한 실시간 데이터 스트리밍과 Redis 캐싱을 활용하여 저지연 고성능 데이터 전달을 구현하며, 종목 교체가 가능한 유연한 위젯 기반 대시보드 구조를 제공합니다.

**아키텍처 스타일**: Layered + Event-Driven Hybrid

### 3.2 아키텍처 레이어

#### Presentation Layer
사용자 인터페이스를 담당하는 레이어로, Next.js 14 기반 SSR/CSR 하이브리드 렌더링과 실시간 데이터 시각화를 제공합니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| Web Application (Next.js SPA) | frontend-application | Next.js 14 App Router 기반 SPA로, TypeScript와 Tailwind CSS를 사용하여 반응형 대시보드 UI를 구현합니다. |
| Chart Widget | ui-component | TradingView Lightweight Charts 라이브러리를 활용한 주식/암호화폐 차트 컴포넌트입니다. |
| Data Fetching Layer (TanStack Query) | client-library | TanStack Query를 활용한 서버 상태 관리 및 데이터 페칭 레이어로, 캐싱/재시도/무효화 전략을 관리합니다. |
| WebSocket Client Manager | client-library | 백엔드 WebSocket 서버와의 실시간 연결을 관리하며, 자동 재연결 및 구독 관리를 수행합니다. |

#### Gateway Layer
클라이언트 요청을 라우팅하고, 로드밸런싱, SSL 종단, 정적 자산 서빙 등을 처리하는 리버스 프록시 레이어입니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| Nginx Reverse Proxy | infrastructure | Nginx 기반 API Gateway로, 프론트엔드 정적 자산 서빙과 백엔드 API/WebSocket 라우팅을 담당합니다. |

#### Application Layer
비즈니스 로직을 처리하는 핵심 레이어로, FastAPI 기반 REST API 서버와 WebSocket 서버로 구성됩니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| REST API Server | service | FastAPI 기반 RESTful API 서버로, 시세 데이터 조회, 종목 정보, 뉴스 등의 엔드포인트를 제공합니다. |
| WebSocket Gateway Server | service | FastAPI WebSocket 엔드포인트로, 클라이언트의 실시간 시세 구독을 관리하고 데이터를 스트리밍합니다. |
| Scheduler Service | service | APScheduler 기반 백그라운드 작업 스케줄러로, 주기적 데이터 수집 및 캐시 갱신을 수행합니다. |

#### Data Service Layer
외부 API 데이터 수집, 정규화, 캐싱 전략을 담당하는 레이어로, 다양한 데이터 소스를 통합 관리합니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| Market Data Service | service | 국내외 주식 시세 및 시장지수 데이터를 통합 관리하는 서비스입니다. |
| Crypto Data Service | service | Upbit WebSocket API를 통한 실시간 암호화폐 시세 데이터를 관리하는 서비스입니다. |
| Precious Metal Data Service | service | metals.live API를 통해 금/은 실시간 시세를 수집 및 관리하는 서비스입니다. |
| Exchange Rate Data Service | service | 한국수출입은행 환율 API를 통해 USD/KRW 등 주요 환율 데이터를 수집 및 관리하는 서비스입니다. |
| News Data Service | service | NewsAPI를 통해 금융 뉴스를 수집하고 종목/시장별로 분류하는 서비스입니다. |
| Real-time Data Aggregator | service | 다양한 실시간 데이터 소스를 통합하여 WebSocket Gateway로 전달하는 이벤트 중계 서비스입니다. |

#### External API Connector Layer
외부 API와의 통신을 캡슐화하는 레이어로, httpx 비동기 클라이언트를 사용하여 각 외부 서비스와의 연결을 관리합니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| KIS OpenAPI Connector | connector | 키움증권 Open API와의 통신을 담당하는 커넥터로, 인증 토큰 관리 및 API 호출을 처리합니다. |
| Upbit WebSocket Connector | connector | Upbit WebSocket API와의 실시간 연결을 관리하는 커넥터입니다. |
| Gold API Connector | connector | metals.live API와의 통신을 담당하는 커넥터입니다. |
| Exchange Rate API Connector | connector | 한국수출입은행 환율 API와의 통신을 담당하는 커넥터입니다. |
| NewsAPI Connector | connector | NewsAPI와의 통신을 담당하는 커넥터입니다. |

#### Cache Layer
Redis 기반 캐싱 레이어로, 빈번히 조회되는 시세 데이터와 실시간 이벤트 Pub/Sub를 처리합니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| Redis Cache | cache | Redis를 활용한 다목적 캐싱 및 메시지 브로커 서비스입니다. |

#### Database Layer
PostgreSQL 기반 영속 데이터 저장 레이어로, 히스토리컬 시세 데이터, 뉴스, 종목 정보 등을 관리합니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| PostgreSQL Database | database | PostgreSQL 16 기반 관계형 데이터베이스로, 영속적 데이터 저장을 담당합니다. |

#### Infrastructure Layer
컨테이너 오케스트레이션, CI/CD, 모니터링을 포함한 인프라 운영 레이어입니다.

| 컴포넌트 | 타입 | 설명 |
|----------|------|------|
| Docker Compose Orchestration | infrastructure | Docker Compose를 통한 멀티 컨테이너 오케스트레이션을 관리합니다. |
| GitHub Actions CI/CD | infrastructure | GitHub Actions 기반 CI/CD 파이프라인으로, 자동 빌드/테스트/배포를 수행합니다. |
| Monitoring Stack (Prometheus + Grafana) | infrastructure | Prometheus 메트릭 수집과 Grafana 시각화를 통한 시스템 모니터링 스택입니다. |
| Logging System | infrastructure | Python logging 기반 구조화된 로깅 시스템으로, 애플리케이션 로그를 수집 및 관리합니다. |

### 3.3 데이터 흐름

사용자 요청은 Nginx Reverse Proxy를 통해 수신되며, 정적 자산 요청은 Nginx에서 직접 서빙하고, API 요청(/api/*)은 FastAPI REST API Server로, WebSocket 요청(/ws/*)은 WebSocket Gateway Server로 라우팅됩니다. REST API 요청 시 각 Data Service는 먼저 Redis Cache를 조회(Cache-Aside)하고, 캐시 미스 시 External API Connector를 통해 외부 API를 호출하여 데이터를 수집한 뒤 Redis에 캐싱하고 응답합니다. 실시간 데이터의 경우, Upbit WebSocket Connector와 KIS OpenAPI Connector가 외부 소스로부터 시세 데이터를 수신하면 Real-time Data Aggregator가 이를 통합하여 Redis Pub/Sub 채널에 발행하고, WebSocket Gateway Server가 해당 채널을 구독하여 연결된 클라이언트에게 브로드캐스트합니다. APScheduler는 장 운영시간에 맞춰 주기적으로 시세/뉴스/귀금속 데이터를 수집하여 PostgreSQL에 히스토리컬 데이터를 적재하고 Redis 캐시를 갱신합니다. 프론트엔드의 TanStack Query는 REST API 응답을 클라이언트 측에서 추가 캐싱하여 불필요한 재요청을 방지하며, WebSocket Client Manager는 사용자의 종목 교체 시 구독 대상을 동적으로 변경하여 해당 종목의 실시간 데이터만 수신합니다.

## 6. 보안 요구사항

| 카테고리 | 요구사항 | 구현 방안 | 우선순위 |
|----------|----------|----------|----------|
| Transport Security | HTTPS 통신 암호화 | Let's Encrypt SSL 인증서 적용 | HIGH |
| API Key Management | 외부 API 키 안전 관리 | 환경변수 기반 시크릿 관리 (.env) | HIGH |
| Rate Limiting | API 남용 방지 | FastAPI 미들웨어 기반 요청 제한 | MEDIUM |

## 7. 성능 요구사항

| 성능 지표 | 목표 값 | 측정 방법 |
|----------|---------|----------|
| API 응답 시간 | 평균 200ms 이하 | APM 도구 모니터링 |
| 동시 사용자 처리 | 100명 이상 | 부하 테스트 |
| 시스템 가용성 | 99.5% 이상 | 업타임 모니터링 |
| 시세 데이터 갱신 지연 | 5초 이내 | WebSocket 레이턴시 측정 |

## 8. 인프라 요구사항

| 카테고리 | 사양 | 수량 | 용도 |
|----------|------|------|------|
| Compute | Application Server (2 vCPU, 4GB RAM) | 1 | 웹/API 서버 (Docker Compose) |
| Database | PostgreSQL 16 (2 vCPU, 4GB RAM, 50GB SSD) | 1 | 주 데이터베이스 |
| Cache | Redis (1 vCPU, 2GB RAM) | 1 | 시세 캐싱 및 Pub/Sub |
| Network | Nginx Reverse Proxy + Let's Encrypt | 1 | HTTPS 종단 및 라우팅 |

> **참고**: 무료 소프트웨어 제약조건에 따라 Oracle Cloud Free Tier(Always Free ARM 인스턴스) 또는 자체 서버 활용을 권장합니다.

## 9. 기술 리스크

| 리스크 | 위험도 | 영향 | 대응방안 |
|--------|--------|------|----------|
| 외부 API 장애/변경 | HIGH | 시세 데이터 수집 중단, 대시보드 공백 | Redis 캐시 폴백, 어댑터 레이어로 API 변경 격리 |
| 키움증권 API 호출 제한 | MEDIUM | 실시간 데이터 지연 | 호출 빈도 최적화, Redis 캐싱으로 중복 호출 방지 |
| WebSocket 동시 접속 부하 | MEDIUM | 서버 메모리/CPU 과부하 | 커넥션 풀링, 구독 채널 최적화 |
| 다중 API 데이터 포맷 불일치 | LOW | 데이터 정규화 복잡도 증가 | 통합 어댑터 레이어, 공통 시세 데이터 모델 정의 |

---

*본 TRD는 '요구사항' PRD를 기반으로 자동 생성되었습니다.*